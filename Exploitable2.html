<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<title>Exploitable2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>

<div id="Injection"><h2 id="Injection">Injection</h2></div>
<ul>
<li>
Incorrectly filtered escape characters:
<pre>
This command is designed to look up user names from a database
statement = "SELECT * FROM users WHERE name = '" + userName + "';"


' OR '1'='1
' OR '1'='1' --
' OR '1'='1' ({
' OR '1'='1' /* 

SELECT * FROM users WHERE name = '' OR '1'='1';

SELECT * FROM users WHERE name = '' OR '1'='1' -- ';

</pre>

</ul>

<ul>
<li>
Incorrect type handling:

<ul>
<li>
This form of SQL injection occurs when a user-supplied field is not strongly typed or is not checked for type constraints. This could take place when a numeric field is to be used in a SQL statement, but the programmer makes no checks to validate that the user supplied input is numeric.

</ul>
</ul>

<ul>
<li>
Mitigation:

<ul>
<li>
Parameterized statements

<ul>
<li>
Instead of embedding user input in the statement. A placeholder can only store a value of the given type and not an arbitrary SQL fragment. Hence the SQL injection would simply be treated as a strange (and probably invalid) parameter value.

</ul>
</ul>
</ul>

<ul>
<li>
Escaping:

<ul>
<li>
Escape chars that have special meaning in SQL

<li>
Create a black list of chars

</ul>
<li>
Pattern checking:

<ul>
<li>
Checking to ensure that the input follows a pattern

</ul>
<li>
DB Perms:

<ul>
<li>
Limit the permissions

</ul>
<li>
Hexing input:

<ul>
<li>
Convert input into hexadecimal

<li>
unhex returns a string which is used not interpreted

</ul>
</ul>
<li>
Story time:

<ul>
<li>
On September 19 during the 2010 Swedish general election a voter attempted a code injection by hand writing SQL commands as part of a writeâ€‘in vote.

<li>
In December 2009, an attacker breached a RockYou plaintext database containing the unencrypted usernames and passwords of about 32 million users using an SQL injection attack

</ul>

<div id="Patch"><h2 id="Patch">Patch</h2></div>
<ul>
<li>
CVE's

</ul>

<div id="XSS"><h2 id="XSS">XSS</h2></div>
<ul>
<li>
Cross-site scripting attacks use known vulnerabilities in web-based applications, their servers, or plug-in systems on which they rely. Exploiting one of these, attackers fold malicious content into the content being delivered from the compromised site. When the resulting combined content arrives at the client-side web browser, it has all been delivered from the trusted source, and thus operates under the permissions granted to that system.

<li>
Usually java script

<li>
Types:

<ul>
<li>
Reflected (non-persistent):

<ul>
<li>
 classic example of a potential vector is a site search engine: if one searches for a string, the search string will typically be redisplayed verbatim on the result page to indicate what was searched for. If this response does not properly escape or reject HTML control characters, a cross-site scripting flaw will ensue

</ul>
<li>
Persistent:

<ul>
<li>
The persistent (or stored) XSS vulnerability is a more devastating variant of a cross-site scripting flaw: it occurs when the data provided by the attacker is saved by the server, and then permanently displayed on "normal" pages returned to other users in the course of regular browsing, without proper HTML escaping. A classic example of this is with online message boards where users are allowed to post HTML formatted messages for other users to read

</ul>
</ul>
<li>
Prevention:

<ul>
<li>
Escaping string input

<li>
Validating untrusted user input

<li>
Disable scripts

<li>
Cookie sec:

<ul>
<li>
Tie Cookie to ip

<li>
Breaks down if attack is behind the same natted ip or web proxy as the victim

</ul>
</ul>
</ul>

<div id="File Permissions"><h2 id="File Permissions">File Permissions</h2></div>
<ul>
<li>
Each file and Dir has three user based perm groups:

<ul>
<li>
Owner (u)- Owner of the file

<li>
Group (g)- Group that has been assigned to the file or dir 

<li>
All users (o/a)- applies to all other users on the system

</ul>
<li>
Types:

<ul>
<li>
Each file or dir has 3 types:

<ul>
<li>
Read (4)

<li>
Write (2)

<li>
Execute (1)

</ul>
</ul>
<li>
ls -l

<ul>
<li>
First set of rwx is owner

<li>
Second set of rwx is Groups

<li>
Third set of rwx is Users

</ul>
<li>
chmod

<ul>
<li>
+ or - (add or remove)

<li>
Ex.) chmod a-rw file.txt

<ul>
<li>
Removes read write perms from file.txt for the all other user group

</ul>
</ul>
<li>
chmod numerical:

<ul>
<li>
chmod 777 file.txt

</ul>
<li>
Perms on specificc directories:

<ul>
<li>

    home directories - The users\' home directories are important because you do not want other users to be able to view and modify the files in another user\'s documents of desktop. To remedy this you will want the directory to have the drwx______ (700) permissions, so lets say we want to enforce the correct permissions on the user user1\'s home directory that can be done by issuing the command chmod 700 /home/user1.
    bootloader configuration files - If you decide to implement password to boot specific operating systems then you will want to remove read and write permissions from the configuration file from all users but root. To do you can change the permissions of the file to 700.
    system and daemon configuration files - It is very important to restrict rights to system and daemon configuration files to restrict users from editing the contents, it may not be advisable to restrict read permissions, but restricting write permissions is a must. In these cases it may be best to modify the rights to 644.
    firewall scripts - It may not always be necessary to block all users from reading the firewall file, but it is advisable to restrict the users from writing to the file. In this case the firewall script is run by the root user automatically on boot, so all other users need no rights, so you can assign the 700 permissions.

</ul>
</ul>

<div id="Insecure Direct Obj Refs"><h2 id="Insecure Direct Obj Refs">Insecure Direct Obj Refs</h2></div>
<ul>
<li>
A direct object reference is likely to occur when a developer exposes a reference to an internal implementation object, such as a file, directory, or database key without any validation mechanism which will allow attackers to manipulate these references to access unauthorized data

<li>
Prevention:

<ul>
<li>
check the access before using a direct object reference from an untrusted source.

</ul>
</ul>
<div id="Known Vulnerable Components"><h2 id="Known Vulnerable Components">Known Vulnerable Components</h2></div>
<ul>
<li>
Find out if you have a KVC:

<ul>
<li>
Search the databases of vulnerabiblites:

<ul>
<li>
<a href="http:&#47;&#47;cve.mitre.org&#47;">http://cve.mitre.org/</a>

<li>
<a href="https:&#47;&#47;nvd.nist.gov&#47;home.cfm">https://nvd.nist.gov/home.cfm</a>

</ul>
</ul>
<li>
Protecting against KVC:

<ul>
<li>
Preventative medicine

<li>
Identify all components and the versions you are using, including all dependencies. (e.g., the versions plugin)

<li>
Monitor the security of these components in public databases, project mailing lists, and security mailing lists, and keep them up to date

<li>
Establish security policies governing component use, such as requiring certain software development practices, passing security tests, and acceptable licenses

<li>
 Where appropriate, consider adding security wrappers around components to disable unused functionality and/ or secure weak or vulnerable aspects of the component

</ul>
<li>
Story time:

<ul>
<li>
Java Spring Framework was vulnerable to remote code execution and it impacted 1.3 million applications.

<li>
Wordpress

</ul>
</ul>

<div id="Buffer Overflow"><h2 id="Buffer Overflow">Buffer Overflow</h2></div>
<ul>
<li>
Prevention:

<ul>
<li>
Choice of language:

<ul>
<li>
Most languages provide runtime checking

</ul>
<li>
STL in C++ is good for bounds checking if the programmer explicitly calls it

<li>
Ex.) Vectors.at() will throw out_of_range exception

<li>
Use of safe libraries:

<ul>
<li>
Not safe:

<ul>
<li>
gets

<li>
scanf

<li>
strcpy

</ul>
<li>
Safe:

<ul>
<li>
Better string lib

<li>
OpenBSD Clib is safe but limited

</ul>
</ul>
<li>
Pointer Protection:

<ul>
<li>
The approach works by having the compiler add code to automatically XOR-encode pointers before and after they are used. Because the attacker (theoretically) does not know what value will be used to encode/decode the pointer, he cannot predict what it will point to if he overwrites it with a new value.

<li>
Microsoft implemented this in windows xp sp2 but it was not automatic

</ul>
<li>
Exploitable space protection:

<ul>
<li>
Dont let the user run code on the heap or stack

<li>
Buffer overflow may allow the user to write code on the stack or heap but with exploitable space protection it will throw an exception

</ul>
<li>
Random address space

</ul>
<li>
Story time:

<ul>
<li>
In 2003, buffer overflows present in licensed Xbox games have been exploited to allow unlicensed software, including homebrew games, to run on the console without the need for hardware modifications, known as modchips.[42] The PS2 Independence Exploit also used a buffer overflow to achieve the same for the PlayStation 2. The Twilight hack accomplished the same with the Wii, using a buffer overflow in The Legend of Zelda: Twilight Princess.

</ul>
</ul>

</body>
</html>
